(()=>{var y=Object.create;var r=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),A=(t,e)=>{for(var o in e)r(t,o,{get:e[o],enumerable:!0})},c=(t,e,o,p)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of b(e))!x.call(t,n)&&n!==o&&r(t,n,{get:()=>e[n],enumerable:!(p=g(e,n))||p.enumerable});return t};var S=(t,e,o)=>(o=t!=null?y(k(t)):{},c(e||!t||!t.__esModule?r(o,"default",{value:t,enumerable:!0}):o,t)),v=t=>c(r({},"__esModule",{value:!0}),t);var m=L((I,i)=>{i.exports=shelter.solidWeb});var W={};A(W,{apps:()=>s,onLoad:()=>C,onUnload:()=>E,settings:()=>h});var l=S(m(),1);var{plugin:{store:f},ui:{SwitchItem:O}}=shelter,h=()=>{let t=[];for(let e of Object.keys(s))t.push((0,l.createComponent)(O,{get value(){return f.enabledApps[e]},onChange:o=>{f.enabledApps[e]=o},children:`${e} Protocol`}));return t};var{plugin:{store:a},patcher:{before:U}}=shelter,s={Spotify:{hostnames:["open.spotify.com","spotify.link"],protocol:"spotify:"},Steam:{hostnames:["store.steampowered.com","steamcommunity.com","help.steampowered.com"],protocol:"steam://openurl/"}};async function R(t){let e=/<meta property="og:url" content="(.+?)"\/>/,o=await(await fetch(`https://shcors.uwu.network/${t}`)).text();return e.exec(o)?.[1]}async function u(t){try{t=new URL(t),t.hostname==="spotify.link"&&(t=new URL(await R(t)));for(let[e,o]of Object.entries(s))if(o.hostnames.includes(t.hostname)&&a.enabledApps[e])return o.protocol+t.toString()}catch{}return t.toString()}var d;function j(){d=U("open",window,async([t])=>[await u(t)])}async function w(t){try{let e=t.target.parentElement.href??t.target.href;if(!e)return;let o=new URL(e);if(!Object.values(s).find(n=>n.hostnames.includes(o.hostname)))return;t.preventDefault(),t.stopImmediatePropagation(),window.open(await u(o))}catch(e){console.error(e)}}function C(){j(),document.addEventListener("click",w),a.enabledApps??={},Object.keys(s).forEach(t=>{a.enabledApps[t]??=!0})}function E(){d?.(),document.removeEventListener("click",w)}return v(W);})();

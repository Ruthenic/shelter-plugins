(()=>{var k=Object.create;var p=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var S=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),U=(t,e)=>{for(var o in e)p(t,o,{get:e[o],enumerable:!0})},l=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of L(e))!E.call(t,r)&&r!==o&&p(t,r,{get:()=>e[r],enumerable:!(n=x(e,r))||n.enumerable});return t};var v=(t,e,o)=>(o=t!=null?k(C(t)):{},l(e||!t||!t.__esModule?p(o,"default",{value:t,enumerable:!0}):o,t)),O=t=>l(p({},"__esModule",{value:!0}),t);var f=S((_,u)=>{u.exports=shelter.solidWeb});var M={};U(M,{apps:()=>c,onLoad:()=>W,onUnload:()=>$,settings:()=>h});var d=v(f(),1);var{plugin:{store:m},ui:{SwitchItem:N}}=shelter,h=()=>{let t=[];for(let[e,o]of Object.entries(c))t.push((0,d.createComponent)(N,{get value(){return m.enabledApps[e]},onChange:n=>{m.enabledApps[e]=n},get note(){return o.protocol},children:e}));return t};var{plugin:{store:a},patcher:{instead:w}}=shelter,c={Spotify:{hostnames:["open.spotify.com","spotify.link"],protocol:"spotify://",default:!0},Steam:{hostnames:["store.steampowered.com","steamcommunity.com","help.steampowered.com"],protocol:"steam://openurl/",default:!0},SoundCloud:{hostnames:["soundcloud.com"],protocol:"soundpout://",default:!1}};function s(t){let{hostname:e}=new URL(t);return Object.entries(c).find(([o,n])=>n.hostnames.includes(e)&&a.enabledApps[o])}async function R(t){let e=/<meta property="og:url" content="(.+?)"\/>/,o=await(await fetch(`https://shcors.uwu.network/${t}`)).text();return e.exec(o)?.[1]}async function i(t){try{t=new URL(t),t.hostname==="spotify.link"&&(t=new URL(await R(t)));let[e,o]=s(t),n=o.protocol+t;window.open(n,"_blank").close()}catch(e){console.error("[open-in-app] Error opening in App",e)}}var y;function j(){y=w("open",window,(t,e)=>{let[o]=t;if(!s(o))return e(...t);i(o)})}var g;async function I(){g=w("click",HTMLAnchorElement.prototype,function(t,e){let{href:o}=this;if(!s(o))return e(...t);i(url)})}async function b(t){let e=t.target;try{if(e.tagName!=="A"&&(e=e?.closest(`:not(${e.tagName})`),e.tagName!=="A"))return;let{href:o}=e;if(!s(o))return;t.preventDefault(),t.stopImmediatePropagation(),i(o)}catch{}}var A=document.querySelector("#app-mount");function W(){a.enabledApps??={},Object.entries(c).forEach(([t,e])=>{console.log(t,e),a.enabledApps[t]??=e.default}),j(),I(),A.addEventListener("click",b)}function $(){y?.(),g?.(),A.removeEventListener("click",b)}return O(M);})();

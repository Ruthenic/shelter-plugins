(()=>{var b=Object.create;var a=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty;var S=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),v=(t,e)=>{for(var o in e)a(t,o,{get:e[o],enumerable:!0})},c=(t,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of k(e))!L.call(t,n)&&n!==o&&a(t,n,{get:()=>e[n],enumerable:!(r=A(e,n))||r.enumerable});return t};var O=(t,e,o)=>(o=t!=null?b(x(t)):{},c(e||!t||!t.__esModule?a(o,"default",{value:t,enumerable:!0}):o,t)),U=t=>c(a({},"__esModule",{value:!0}),t);var m=S((P,i)=>{i.exports=shelter.solidWeb});var W={};v(W,{apps:()=>s,onLoad:()=>E,onUnload:()=>$,settings:()=>u});var l=O(m(),1);var{plugin:{store:f},ui:{SwitchItem:N}}=shelter,u=()=>{let t=[];for(let e of Object.keys(s))t.push((0,l.createComponent)(N,{get value(){return f.enabledApps[e]},onChange:o=>{f.enabledApps[e]=o},children:`${e} Protocol`}));return t};var{plugin:{store:p},patcher:{before:R}}=shelter,s={Spotify:{hostnames:["open.spotify.com","spotify.link"],protocol:"spotify:"},Steam:{hostnames:["store.steampowered.com","steamcommunity.com","help.steampowered.com"],protocol:"steam://openurl/"}};async function j(t){let e=/<meta property="og:url" content="(.+?)"\/>/,o=await(await fetch(`https://shcors.uwu.network/${t}`)).text();return e.exec(o)?.[1]}async function h(t){try{t=new URL(t),t.hostname==="spotify.link"&&(t=new URL(await j(t)));for(let[e,o]of Object.entries(s))if(o.hostnames.includes(t.hostname)&&p.enabledApps[e])return o.protocol+t.toString()}catch{}return t.toString()}var d;function C(){d=R("open",window,async([t])=>[await h(t)])}async function w(t){let e=t.target;try{if(e.tagName!=="A"&&(e=e?.closest(`:not(${e.tagName})`),e.tagName!=="A"))return;let o=e?.href;if(!o)return;let r=new URL(o);if(!Object.values(s).find(g=>g.hostnames.includes(r.hostname)))return;t.preventDefault(),t.stopImmediatePropagation(),window.open(await h(r))}catch{}}var y=document.querySelector("#app-mount");function E(){C(),y.addEventListener("click",w),p.enabledApps??={},Object.keys(s).forEach(t=>{p.enabledApps[t]??=!0})}function $(){d?.(),y.removeEventListener("click",w)}return U(W);})();

(()=>{var V=Object.create;var a=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var R=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),U=(e,t)=>{for(var n in t)a(e,n,{get:t[n],enumerable:!0})},f=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of D(t))!$.call(e,o)&&o!==n&&a(e,o,{get:()=>t[o],enumerable:!(r=j(t,o))||r.enumerable});return e};var c=(e,t,n)=>(n=e!=null?V(L(e)):{},f(t||!e||!e.__esModule?a(n,"default",{value:e,enumerable:!0}):n,e)),O=e=>f(a({},"__esModule",{value:!0}),e);var s=R((W,v)=>{v.exports=shelter.solidWeb});var B={};U(B,{insertTimer:()=>l,onLoad:()=>N,onUnload:()=>z,settings:()=>g});var p=c(s(),1);var T=c(s(),1),C=c(s(),1);var P=(0,T.template)("<p></p>",2),{solid:{createSignal:A,onCleanup:E},plugin:{store:M}}=shelter;function h(e){let t=Math.floor(e/3600),n=Math.floor(e/60)-t*60,r=Math.floor(e-t*3600-n*60);return(t?t.toString()+":":"")+n.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")}var d=()=>{let e=()=>(Date.now()-M.joinTime)/1e3,[t,n]=A(h(e())),r=setInterval(()=>n(h(e())),1e3);return E(()=>{clearInterval(r),l()}),(()=>{let o=P.cloneNode(!0);return o.style.setProperty("display","inline"),o.style.setProperty("font-family","monospace"),(0,C.insert)(o,()=>t()+" \u2022 "),o})()};var _=c(s(),1),{plugin:{store:S},ui:{SwitchItem:k}}=shelter,g=()=>(0,_.createComponent)(k,{get value(){return S.persistTime},onChange:e=>S.persistTime=e,note:"Time resets after 10 seconds of not being in a voice channel",children:"Persist time across channel moves"});var{flux:{dispatcher:u,awaitStore:q},ui:{ReactiveRoot:G},plugin:{store:i},observeDom:K}=shelter,b='[class^="rtcConnectionStatus"] + a > div[class*="subtext"]:not(:has(.ioj4-vct))',m=!1;async function l(){if(m||!i.isInVC)return;m=!0;let e=document.querySelector(b)??await new Promise(n=>{let r=K(b,n);setTimeout(()=>{r(),n()},2e3)});if(!e){m=!1;return}let t=(0,p.createComponent)(G,{get children(){return(0,p.createComponent)(d,{})}});t.className="ioj4-vct",e.prepend(t),m=!1}var x=0;function y(){i.isInVC||(i.isInVC=!0,(!i.persistTime||x<Date.now()-1e4)&&(i.joinTime=Date.now())),l()}function I(e){e.event==="join_voice_channel"?y():e.event==="leave_voice_channel"&&(i.isInVC=!1,x=Date.now())}function w(){i.isInVC=!1}async function N(){(await q("VoiceStateStore")).isCurrentClientInVoiceChannel()&&y(),u.subscribe("TRACK",I),u.subscribe("LOGOUT",w)}function z(){i.isInVC=!1,u.unsubscribe("TRACK",I),u.unsubscribe("LOGOUT",w),document.querySelectorAll(".ioj4-vct").forEach(e=>e.remove())}return O(B);})();

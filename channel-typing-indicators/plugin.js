(()=>{var E=Object.create;var s=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var C=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),N=(t,n)=>{for(var i in n)s(t,i,{get:n[i],enumerable:!0})},m=(t,n,i,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let e of A(n))!$.call(t,e)&&e!==i&&s(t,e,{get:()=>n[e],enumerable:!(o=x(n,e))||o.enumerable});return t};var c=(t,n,i)=>(i=t!=null?E(I(t)):{},m(n||!t||!t.__esModule?s(i,"default",{value:t,enumerable:!0}):i,t)),v=t=>m(s({},"__esModule",{value:!0}),t);var r=C((O,l)=>{l.exports=shelter.solidWeb});var R={};N(R,{onLoad:()=>k,onUnload:()=>w});var b=c(r(),1);var u="._indicator_1obqu_1{margin-left:4px}._indicator_1obqu_1 span{height:6px;width:6px;float:left;margin:0 1px;background-color:var(--text-normal);display:block;border-radius:50%;opacity:.3}._indicator_1obqu_1 span:nth-child(1){animation:1s ease-in 0.2s _typingAnimation_1obqu_1;animation-iteration-count:infinite}._indicator_1obqu_1 span:nth-child(2){animation:1s ease-in 0.4s _typingAnimation_1obqu_1;animation-iteration-count:infinite}._indicator_1obqu_1 span:nth-child(3){animation:1s ease-in 0.6s _typingAnimation_1obqu_1;animation-iteration-count:infinite}@keyframes _typingAnimation_1obqu_1{33.3%{opacity:1;transform:scale(1.2)}}",a={indicator:"_indicator_1obqu_1",typingAnimation:"_typingAnimation_1obqu_1"};var d=c(r(),1),f=c(r(),1),g=c(r(),1);var G=(0,d.template)("<div><span></span><span></span><span></span></div>",8),h=()=>(()=>{let t=G.cloneNode(!0);return(0,g.effect)(()=>(0,f.className)(t,a.indicator)),t})();var{ui:{injectCss:P},flux:{dispatcher:S,awaitStore:y},solidWeb:{render:U}}=shelter;async function T(t){let n=y("UserStore");if(t?.userId===n?.getCurrentUser()?.id)return;let i=document.querySelector(`[data-list-item-id="channels___${t?.channelId}"]`)?.parentElement;if(!i)return;let o=i.querySelector('div[class^="children-"]');if(o)switch(t?.type){case"TYPING_START":{if(!o.querySelector(`.${a.indicator}`)){let e=document.createElement("div");o.prepend(e),U(()=>(0,b.createComponent)(h,{}),e)}return}case"TYPING_STOP":case"MESSAGE_CREATE":{let e=o.querySelector(`.${a.indicator}`);if(!e)return;let _=(await y("TypingStore"))?.getTypingUsers(t?.channelId);(!_||Object.keys(_).length===0)&&e.remove()}}}var p,q=["TYPING_START","TYPING_STOP","MESSAGE_CREATE"];function k(){q.forEach(t=>S.subscribe(t,T)),p=P(u)}function w(){q.forEach(t=>S.unsubscribe(t,T)),p&&p()}return v(R);})();

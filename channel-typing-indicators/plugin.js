(()=>{var P=Object.create;var l=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var $=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),G=(n,t)=>{for(var e in t)l(n,e,{get:t[e],enumerable:!0})},h=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of L(t))!O.call(n,o)&&o!==e&&l(n,o,{get:()=>t[o],enumerable:!(i=D(t,o))||i.enumerable});return n};var y=(n,t,e)=>(e=n!=null?P(k(n)):{},h(t||!n||!n.__esModule?l(e,"default",{value:n,enumerable:!0}):e,n)),M=n=>h(l({},"__esModule",{value:!0}),n);var u=$((en,g)=>{g.exports=shelter.solidWeb});var Z={};G(Z,{channelElementQuery:()=>c,onLoad:()=>V,onUnload:()=>X});var b="._indicator_1obqu_1{margin-left:4px}._indicator_1obqu_1 span{height:6px;width:6px;float:left;margin:0 1px;background-color:var(--text-normal);display:block;border-radius:50%;opacity:.3}._indicator_1obqu_1 span:nth-child(1){animation:1s ease-in 0.2s _typingAnimation_1obqu_1;animation-iteration-count:infinite}._indicator_1obqu_1 span:nth-child(2){animation:1s ease-in 0.4s _typingAnimation_1obqu_1;animation-iteration-count:infinite}._indicator_1obqu_1 span:nth-child(3){animation:1s ease-in 0.6s _typingAnimation_1obqu_1;animation-iteration-count:infinite}@keyframes _typingAnimation_1obqu_1{33.3%{opacity:1;transform:scale(1.2)}}",a={indicator:"_indicator_1obqu_1",typingAnimation:"_typingAnimation_1obqu_1"};var E=y(u(),1);var S=y(u(),1),F=(0,S.template)("<div><span></span><span></span><span></span></div>",8),I=()=>F.cloneNode(!0);var{flux:{awaitStore:T},solidWeb:{render:W},util:{getFiber:R,reactFiberWalker:Y}}=shelter;function A(){document.querySelectorAll(c).forEach(t=>{let e=R(t);Y(e,({stateNode:r})=>r&&!(r instanceof Element),!0)?.stateNode?.forceUpdate()})}function C(n){return document.querySelector(`[data-list-item-id="channels___${n}"]`)?.parentElement?.querySelector('div[class^="children_"]')}async function d(n){C(n)?.querySelector(`.${a.indicator}`)?.remove()}function m(n){let t=C(n);if(t&&!t.querySelector(`.${a.indicator}`)){let e=document.createElement("div");e.classList.add(a.indicator),t.prepend(e),W(()=>(0,E.createComponent)(I,{}),e)}}async function _(n){let t=await T("TypingStore"),i=(await T("UserStore")).getCurrentUser().id;return Object.keys(t.getTypingUsers(n)).filter(r=>r!==i).length!==0}function q(){document.querySelectorAll(`.${a.indicator}`).forEach(n=>n.remove())}var{ui:{injectCss:j},flux:{dispatcher:s,awaitStore:H},util:{getFiber:Q,reactFiberWalker:z},patcher:B,observeDom:J}=shelter,c='a[data-list-item-id^="channels___"]:not([class^="mainContent"])',p=!1,x;async function N({type:n,userId:t,channelId:e}){let i=await H("UserStore");if(t!==i.getCurrentUser().id)switch(n){case"TYPING_START":return m(e);case"TYPING_STOP":case"MESSAGE_CREATE":await _(e)||d(e)}}function U(n){let t=Q(n),e=z(t,i=>!!i?.type?.render,!0);e&&(x=B.after("render",e.type,i=>{let o=i[0]["data-list-item-id"];if(!o)return;let r=o.split("___")[1];queueMicrotask(async()=>{await _(r)?m(r):d(r)})}),p=!0,A())}async function f(){let n=J(c,t=>{p||(U(t),n(),s.unsubscribe("UPDATE_CHANNEL_LIST_DIMENSIONS",f))});setTimeout(n,1e3)}function K(){let n=document.querySelector(c);n&&U(n)}var v,w=["TYPING_START","TYPING_STOP","MESSAGE_CREATE"];function V(){v=j(b),K(),w.forEach(n=>s.subscribe(n,N)),!p&&s.subscribe("UPDATE_CHANNEL_LIST_DIMENSIONS",f)}function X(){w.forEach(n=>s.unsubscribe(n,N)),s.unsubscribe("UPDATE_CHANNEL_LIST_DIMENSIONS",f),v?.(),x?.(),p=!1,q()}return M(Z);})();

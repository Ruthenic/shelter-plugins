(()=>{var M=Object.create;var o=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var G=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),O=(e,t)=>{for(var n in t)o(e,n,{get:t[n],enumerable:!0})},p=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of U(t))!I.call(e,r)&&r!==n&&o(e,r,{get:()=>t[r],enumerable:!(s=N(t,r))||s.enumerable});return e};var u=(e,t,n)=>(n=e!=null?M(D(e)):{},p(t||!e||!e.__esModule?o(n,"default",{value:e,enumerable:!0}):n,e)),T=e=>p(o({},"__esModule",{value:!0}),e);var a=G((K,f)=>{f.exports=shelter.solidWeb});var j={};O(j,{forceAddUsernames:()=>c,onLoad:()=>W,onUnload:()=>B,settings:()=>E});var S=u(a()),b=u(a());var h=u(a());var{plugin:{store:g},ui:{SwitchItem:L}}=shelter,E=()=>(0,h.createComponent)(L,{get value(){return g.usernameOnly},onChange:e=>{g.usernameOnly=e,c()},children:"Display the username only"});var R=(0,S.template)('<span style="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);"></span>',2),{plugin:{store:_},flux:{dispatcher:i,stores:{GuildMemberStore:v,ChannelStore:$,RelationshipStore:w,SelectedChannelStore:P}},util:{getFiber:q,reactFiberWalker:F},observeDom:H}=shelter;function c(){for(let e of document.querySelectorAll("[id^=message-username-]"))C(e)}function C(e){e.dataset.ysink_su=!0;let t=F(q(e),"message",!0)?.pendingProps?.message;if(!t||!t?.author)return;let{username:n,id:s}=t.author,{type:r,guild_id:x}=$.getChannel(t?.channel_id),l=r?w.getNickname(s):v.getNick(x,s),z="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);",k=(()=>{let m=R.cloneNode(!0);return(0,b.insert)(m,n),m})();e.firstElementChild.textContent=l&&!_.usernameOnly?" "+l:"",e.firstElementChild.prepend(k)}function d(){let e=H('[id^=message-username-]:not([data-ysink_su="true"])',t=>{e(),queueMicrotask(()=>C(t))});setTimeout(e,500)}function y(e){e.message.channel_id===P.getCurrentlySelectedChannelId()&&d()}var A=["CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS","GUILD_MEMBER_UPDATE"];function W(){_.usernameOnly??=!1;for(let e of A)i.subscribe(e,d);i.subscribe("MESSAGE_CREATE",y)}function B(){for(let e of A)i.unsubscribe(e,d);i.unsubscribe("MESSAGE_CREATE",y)}return T(j);})();

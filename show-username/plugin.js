(()=>{var k=Object.create;var s=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var D=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),v=(e,t)=>{for(var n in t)s(e,n,{get:t[n],enumerable:!0})},l=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of I(t))!O.call(e,r)&&r!==n&&s(e,r,{get:()=>t[r],enumerable:!(o=A(t,r))||o.enumerable});return e};var u=(e,t,n)=>(n=e!=null?k(U(e)):{},l(t||!e||!e.__esModule?s(n,"default",{value:e,enumerable:!0}):n,e)),G=e=>l(s({},"__esModule",{value:!0}),e);var a=D((j,m)=>{m.exports=shelter.solidWeb});var P={};v(P,{addUsernames:()=>i,onLoad:()=>H,onUnload:()=>K,settings:()=>g});var h=u(a()),S=u(a());var f=u(a());var{plugin:{store:p},ui:{SwitchItem:L}}=shelter,g=()=>(0,f.createComponent)(L,{get value(){return p.usernameOnly},onChange:e=>{p.usernameOnly=e,i(!0)},children:"Display the username only"});var M=(0,h.template)('<span style="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);"></span>',2),{plugin:{store:E},flux:{dispatcher:b,stores:{GuildMemberStore:T,ChannelStore:$,RelationshipStore:R}},util:{getFiber:w,reactFiberWalker:q},observeDom:F}=shelter;function i(e){for(let t of document.querySelectorAll("[id^=message-username-]")){if(t?.dataset?.YSINK_SU&&!e)continue;t.dataset.YSINK_SU=!0;let n=q(w(t),"message",!0).pendingProps?.message,o=n.author?.username,r=n?.author?.id,{type:x,guild_id:y}=$.getChannel(n?.channel_id),c=x?R.getNickname(r):T.getNick(y,r);if(!o)continue;let W="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);",N=(()=>{let d=M.cloneNode(!0);return(0,S.insert)(d,o),d})();t.firstElementChild.textContent=c&&!E.usernameOnly?" "+c:"",t.firstElementChild.prepend(N)}}var _=["MESSAGE_CREATE","CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS"];function C(){let e=F("[id^=message-username-]",()=>{e(),queueMicrotask(i)});setTimeout(e,500)}function H(){E.usernameOnly??=!1;for(let e of _)b.subscribe(e,C)}function K(){for(let e of _)b.unsubscribe(e,C)}return G(P);})();

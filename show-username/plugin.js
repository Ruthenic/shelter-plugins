(()=>{var A=Object.create;var s=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var D=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),G=(e,t)=>{for(var n in t)s(e,n,{get:t[n],enumerable:!0})},m=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of U(t))!O.call(e,o)&&o!==n&&s(e,o,{get:()=>t[o],enumerable:!(r=I(t,o))||r.enumerable});return e};var u=(e,t,n)=>(n=e!=null?A(k(e)):{},m(t||!e||!e.__esModule?s(n,"default",{value:e,enumerable:!0}):n,e)),L=e=>m(s({},"__esModule",{value:!0}),e);var a=D((Y,d)=>{d.exports=shelter.solidWeb});var P={};G(P,{addUsernames:()=>i,onLoad:()=>H,onUnload:()=>K,settings:()=>g});var S=u(a()),h=u(a());var f=u(a());var{plugin:{store:p},ui:{SwitchItem:M}}=shelter,g=()=>(0,f.createComponent)(M,{get value(){return p.usernameOnly},onChange:e=>{p.usernameOnly=e,i(!0)},children:"Display the username only"});var T=(0,S.template)('<span style="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);"></span>',2),{plugin:{store:E},flux:{dispatcher:_,stores:{GuildMemberStore:$,ChannelStore:v,RelationshipStore:R}},util:{getFiber:q,reactFiberWalker:w},observeDom:F}=shelter;function i(e){for(let t of document.querySelectorAll("[id^=message-username-]")){if(t?.dataset?.YSINK_SU&&!e)continue;t.dataset.YSINK_SU=!0;let n=w(q(t),"message",!0).pendingProps?.message,r=n.author?.username,o=n?.author?.id,{type:N,guild_id:x}=v.getChannel(n?.channel_id),l=N?R.getNickname(o):$.getNick(x,o);if(!r)continue;let y=(()=>{let c=T.cloneNode(!0);return(0,h.insert)(c,r),c})();t.firstElementChild.textContent=l&&!E.usernameOnly?" "+l:"",t.firstElementChild.prepend(y)}}var C=["MESSAGE_CREATE","CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS"];function b(){let e=F("[id^=message-username-]",()=>{e(),queueMicrotask(i)});setTimeout(e,500)}function H(){E.usernameOnly??=!1;for(let e of C)_.subscribe(e,b)}function K(){for(let e of C)_.unsubscribe(e,b)}return L(P);})();

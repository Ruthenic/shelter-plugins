(()=>{var C=Object.create;var r=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty;var N=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),A=(e,t)=>{for(var n in t)r(e,n,{get:t[n],enumerable:!0})},u=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of x(t))!_.call(e,o)&&o!==n&&r(e,o,{get:()=>t[o],enumerable:!(s=b(t,o))||s.enumerable});return e};var I=(e,t,n)=>(n=e!=null?C(y(e)):{},u(t||!e||!e.__esModule?r(n,"default",{value:e,enumerable:!0}):n,e)),O=e=>u(r({},"__esModule",{value:!0}),e);var c=N((H,l)=>{l.exports=shelter.solidWeb});var w={};A(w,{onLoad:()=>R,onUnload:()=>q,settings:()=>p});var m=I(c()),{plugin:{store:d},ui:{SwitchItem:k}}=shelter,p=()=>(0,m.createComponent)(k,{get value(){return d.usernameOnly},onChange:e=>d.usernameOnly=e,children:"Display the username only"});var{plugin:{store:i},flux:{dispatcher:f,stores:{GuildMemberStore:U,ChannelStore:D,RelationshipStore:G}},util:{getFiber:L,reactFiberWalker:M},observeDom:T}=shelter;function v(){for(let e of document.querySelectorAll("[id^=message-username-]")){if(e?.dataset?.YSINK_SU)continue;e.dataset.YSINK_SU=!0;let t=M(L(e),"message",!0).pendingProps?.message,n=t.author?.username,s=t?.author?.id,{type:o,guild_id:S}=D.getChannel(t?.channel_id),E=o?G.getNickname(s):U.getNick(S,s);if(!n)continue;let a=document.createElement("span");a.textContent=n,a.style="font-weight: 600;border-radius: 5px;padding-left: 3px;padding-right: 3px;background: var(--background-secondary);",e.firstElementChild.textContent=E&&!i.usernameOnly?" "+e.firstElementChild.textContent:"",e.firstElementChild.prepend(a)}}var g=["MESSAGE_CREATE","CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS"];function h(){let e=T("[id^=message-username-]",()=>{e(),queueMicrotask(v)});setTimeout(e,500)}function R(){i.usernameOnly=i.usernameOnly??!1;for(let e of g)f.subscribe(e,h)}function q(){for(let e of g)f.unsubscribe(e,h)}return O(w);})();

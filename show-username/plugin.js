(()=>{var M=Object.create;var s=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var G=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),O=(e,n)=>{for(var t in n)s(e,t,{get:n[t],enumerable:!0})},p=(e,n,t,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of U(n))!I.call(e,r)&&r!==t&&s(e,r,{get:()=>n[r],enumerable:!(o=N(n,r))||o.enumerable});return e};var u=(e,n,t)=>(t=e!=null?M(D(e)):{},p(n||!e||!e.__esModule?s(t,"default",{value:e,enumerable:!0}):t,e)),T=e=>p(s({},"__esModule",{value:!0}),e);var a=G((K,f)=>{f.exports=shelter.solidWeb});var j={};O(j,{forceAddUsernames:()=>c,onLoad:()=>W,onUnload:()=>B,settings:()=>E});var S=u(a()),b=u(a());var h=u(a());var{plugin:{store:g},ui:{SwitchItem:L}}=shelter,E=()=>(0,h.createComponent)(L,{get value(){return g.usernameOnly},onChange:e=>{g.usernameOnly=e,c()},children:"Display the username only"});var R=(0,S.template)('<span style="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);"></span>',2),{plugin:{store:C},flux:{dispatcher:i,stores:{GuildMemberStore:v,ChannelStore:$,RelationshipStore:w,SelectedChannelStore:P}},util:{getFiber:q,reactFiberWalker:F},observeDom:H}=shelter;function c(){for(let e of document.querySelectorAll("[id^=message-username-]"))_(e)}function _(e){let n=F(q(e),"message",!0)?.pendingProps?.message;if(!n)return;let t=n?.author?.username,o=n?.author?.id,{type:r,guild_id:x}=$.getChannel(n?.channel_id),l=r?w.getNickname(o):v.getNick(x,o);if(!t)return;let z="font-weight: 600;border-radius: 5px;padding: 0 3px;background: var(--background-secondary);",k=(()=>{let m=R.cloneNode(!0);return(0,b.insert)(m,t),m})();e.firstElementChild.textContent=l&&!C.usernameOnly?" "+l:"",e.firstElementChild.prepend(k)}function d(){let e=H('[id^=message-username-]:not([data-ysink_su="true"])',n=>{e(),queueMicrotask(()=>_(n))});setTimeout(e,500)}function y(e){e.message.channel_id===P.getCurrentlySelectedChannelId()&&d()}var A=["CHANNEL_SELECT","LOAD_MESSAGES_SUCCESS","UPDATE_CHANNEL_DIMENSIONS","GUILD_MEMBER_UPDATE"];function W(){C.usernameOnly??=!1;for(let e of A)i.subscribe(e,d);i.subscribe("MESSAGE_CREATE",y)}function B(){for(let e of A)i.unsubscribe(e,d);i.unsubscribe("MESSAGE_CREATE",y)}return T(j);})();
